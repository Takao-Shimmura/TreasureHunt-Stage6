{% extends "layout.html"%}

{% block title%}


ÂÆùÊé¢„Åó„Ç≤„Éº„É†„ÄÄÁµåÁµ°ÁµåÁ©¥Ê¶ÇË´ñ
{% endblock%}

{% block headline%}
{{title}}

{% endblock%}
<!--{% block header%}
{{message}}
{% endblock%} -->

{% block content %}


<!-- Vue.js container -->

<div id="app" class="m-3">

    <message_board/>
</div>


<!-- message_board's template -->
{% raw %}
<!-- <script type="vue/x=template" id="message_board-template"> -->
<script type="text/x-template" id="message_board-template">
<div>
    <div class="text-right h6">
        <a href="javascript:void(0)"
        v-on:click="in_out_check">{{in_out}}</a>
    </div>
    
    <div class="alert alert-success p-1 ">
        <div v-if="!(login_name=='admin')">
            <h5>{{alert_msg}}</h5>
        </div>
        <div v-else>
            <h5>ÁÆ°ÁêÜËÄÖÁîªÈù¢</h5>
        </div>   
    </div>


    <!--ÂÖ•Âäõ„ÄÄÊé≤Á§∫„Éë„Éç„É´-->
    <div v-if="login_flg">
        <div class="card">
            <div class="card-header">

                

                        <div v-if="login_name=='admin'">
                            <div class="card mt-4">
                                <div class="card-body">
                                    
                                    <div class="form-group">
                                        <button v-on:click="delMsg"
                                            class="btn btn-primary col-12 col-sm-6 col-md-4 col-lg-4 col-xl-4">
                                            ÂÖ•ÂäõÂ±•Ê≠¥ÂâäÈô§</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div v-else>
                            <div v-if="!(current_stege==6)">
                                <div v-if="current_stege==7">
                                    <h5 class="mt-4">
                                        üå∏ÂÖ®„Çπ„ÉÜ„Éº„Ç∏„ÇØ„É™„Ç¢üå∏
                                    </h5>
                                </div>
                                <div v-else>
                                    <h5 class="mt-4">
                                        üëá3Ê°Å„ÅÆÊï∞Â≠ó„ÇíÂÖ•ÂäõÔºàÂçäËßíÊï∞Â≠ó„ÅßÔºâ
                                    </h5>
                                </div>
                            </div>
                            <div v-else-if="current_stege==6">
                                <h5 class="mt-4">
                                    üëá„Ç´„ÇÆ„ÇíÂÖ•ÂäõÔºàÂÖ®Ëßí„Ç´„Çø„Ç´„Éä„ÅßÔºâ
                                </h5>
                            </div>

                            <div v-if="!(current_stege==7)">
                                <!-- ‚Üë„ÄÄÂÖ®„Çπ„ÉÜ„Éº„Ç∏„Çí„ÇØ„É™„Ç¢„Åó„Åü„Çâ„ÄÅÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÅåÊ∂à„Åà„Çã -->
                                <div v-if="inputform_show == 'True'">
                                    <!-- ‚Üë„ÄÄ„Éè„Ç∫„É¨„Åü„Çâ„ÄÅÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÅåÊ∂à„Åà„Çã -->
                                    <div class="card mt-4 ">
                                        <div class="card-body ">
                                            
                                                
                                                    <!-- ‚Üì„ÄÄËá™‰Ωú„ÅÆCSS„ÅØ„ÄÄlayout.html„Éï„Ç°„Ç§„É´„ÅÆ„Å™„Åã„ÅÆ<head></head>ÂÜÖ„Å´Ë®≠ÂÆö„Åó„Å¶„ÅÇ„Çã„Äåhaikei_css_jisaku„Äç -->
                                                    <div class="form-group haikei_css_jisaku">
                                                        

                                                        <label for="comment">ÂÖ•ÂäõÊ¨Ñ</label>
                                                            <div class="row my-5">
                                                                <!-- <div class="col-2">
                                                                </div>-->
                                                            <input type="text"  class="form-control col" 
                                                                id="comment" name="comment" v-model="post_msg">
                                                            <button v-on:click="postMsg"
                                                                class="btn btn-primary col-3 col-sm-2 col-md-3 col-lg-4 col-xl-4">
                                                                ÈÄÅ‰ø°</button>
                                                            </div>
                                                        

                                                        
                                                    </div>
                                                
                                            
                         
                                        </div>
                                    </div>
                                </div>

                                <div v-if="!(inputform_show == 'True')">
                                    <!-- ‚Üë„ÄÄ„Éè„Ç∫„É¨„Åü„Çâ„ÄÅÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÅåÂÜçÈñã„Åï„Çå„Çã„Åæ„Åß„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ -->
                                    <div class="card mt-4">
                                        <div class="card-body">
                                            <div class="alert alert-success p-1">
                                                <h5>{{hazure_countdown_msg}}</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>



        </div>
        </div>
         <div v-if="login_flg">
            <div class="card-body">
           
                <h5 class="p-3 h5 text-center">
                    *ÂÖ•ÂäõÂ±•Ê≠¥*
                </h5>
                <ul class="list-group list-group-flush">
                    <div v-if="login_name =='admin'">
                        <li v-for="item in msg_data"
                        class=" list-group-item">
                            <!-- ‚Üë„ÄÄlogin_name„Ååadmin„Å†„Å£„ÅüÊôÇ„Å´„ÅØ„ÄÅÂ±•Ê≠¥„ÅÆ„Åô„Åπ„Å¶„ÇíË°®Á§∫ -->
                            {{item['input_key']}}    „Äê{{item['name']}}„Äë
                        </li>
                    </div>
                    <div v-else>
                        <div v-for="item in msg_data">
                                <!-- ‚Üë„ÄÄÂêå„Åògroup_name„ÅÆ‰∫∫„ÅåÈÅéÂéª„Å´Êé≤Ëºâ„Åó„Åü„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆ„ÅøË°®Á§∫„Åó„Å¶„ÅÑ„Åè -->
                            <li  class=" list-group-item">
                                {{item['input_key']}}     ({{item['name']}})
                            </li>
                        </div>
                    </div>
                </ul>
            </div>
        </div>

    </div>




    <!-- Login Dialog -->
    <div class="modal fade" id="login">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">
                            {{login_msg}}
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="group">„ÉÅ„Éº„É†Âêç</label>
                            <input type="text"  class="form-control " id="group_input" name="group_input" v-model="group_name">
                            <small class="form-text text-muted">
                                ‚Äª„ÉÅ„Éº„É†ÂêçÔºàËã±Â≠óÔºâ„ÇíÂçäËßíÂ§ßÊñáÂ≠ó„ÅßÂÖ•Âäõ
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="group">ÂêçÂâç</label>
                            <input type="text"  class="form-control " id="name_input" name="name_input" v-model="name_id">
                            <small class="form-text text-muted">
                                ‚ÄªÂêçÂ≠óÔºàÂßìÔºâ„ÇíÊº¢Â≠ó„ÅßÂÖ•Âäõ
                            </small>
                        </div>
                        <div class="form-group">
                            <button class="btn btn=primary" v-on:click="login">„É≠„Ç∞„Ç§„É≥</button>
                        </div>
                    </div>
                </div>
            </div>   
        </div>
    </div>

    <!-- Hazure Dialog -->
    <div class="modal fade" id="Hazure">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">
                            ‰∏çÊ≠£Ëß£ÔºÅ
                        </h4>
                    </div>
                    <div class="card-body">
                        <img class="card-img" src="/static/hazure_001.gif?20230123">
                    </div>
                    <div class="form-group">
                        <button class="btn btn=primary" v-on:click="closeHazure">Èñâ„Åò„Çã</button>
                    </div>
                </div>
            </div>   
        </div>
    </div>



    <!-- TreasureBox Dialog -->
    <div class="modal fade" id="TreasureBox">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">
                            {{form_msg}}
                        </h4>
                    </div>
                    <div class="card-body">
                        <!--„ÄÄ‚Üì„ÄÄsrc= „ÅÆÂèÇÁÖßÈÉ®ÂàÜ„ÅÆURLÂÜÖ„Å´„ÄÅVue.jsÂÜÖ„ÅßÂÆöÁæ©„Åó„ÅüÂ§âÊï∞„Äåcurrent_stege„Äç„ÇíÂÖ•„ÇåËæº„Çì„Åß
                        „ÄÄ„ÄÄ    ÂãïÁöÑ„Å™URL„Å´„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅ{{current_stege}}„Å®Êã¨„ÇãÂøÖË¶Å„ÅØ„Å™„Åè„ÄÅ
                                Âõ∫ÂÆö„ÅÆURLÈÉ®ÂàÜ„ÇíÊñáÂ≠óÂàó„Å®„Åó„Å¶„Ç∑„É≥„Ç∞„É´„ÇØ„Ç©„Éº„Éà„ÅßÊã¨„Çä„ÄÅ„Åù„Åì„Å´ÔºãË®òÂè∑„Åß„Äåcurrent_stege„Äç„ÇíÂÖ•„ÇåËæº„ÇÄ
                                „Åï„Çâ„Å´„ÄÅsrc= „Å´„ÄÅÊòéÁ§∫ÁöÑ„Å´„Äåv-bind:„Äç„Å®Êé•È†≠Ë™û„Çí„Å§„Åë„ÇãÔºàÁúÅÁï•ÂèØÔºâ
                                ÂèÇÁÖß‚áíhttps://www.web-dev-qa-db-ja.com/ja/javascript/vuejs-img-src%E5%A4%89%E6%95%B0%E3%81%A8%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%92%E9%80%A3%E7%B5%90%E3%81%99%E3%82%8B/827523891/
                        -->
                        <img class="card-img" v-bind:src="'/static/TreasureBoxOpen'+current_stege_for_treasurebox+'.gif?20230123'">
                    </div>
                    <div class="form-group">
                        <button class="btn btn=primary" v-on:click="closeTreasureBox">Èñâ„Åò„Çã</button>
                    </div>
                </div>
            </div>   
        </div>
    </div>
</div>
</script>
{% endraw %}

<!-- ******************** -->
<!-- * Vue.js Component Script * -->
<!-- ******************** -->
<script>
    /*‚Üì‚Üì„ÄÄsetIntervalÈñ¢Êï∞ (‰∏ÄÂÆöÊôÇÈñì„ÅåÁµåÈÅé„Åô„Çã„Å®„Éá„Éº„Çø„ÇíËá™ÂãïÊõ¥Êñ∞„ÅóÁ∂ö„Åë„Å¶„Åè„Çå„Çã)„ÄÄ*/
    /*‚Üì‚Üì„ÄÄ„Å®„ÄÅclearIntervalÈñ¢Êï∞Ôºà„Åù„ÅÆËß£Èô§ÂΩπ„Çí„Åó„Å¶„Åè„Çå„ÇãÔºâ„ÅÆ„Åü„ÇÅ„ÅÆ„ÄåÂ§âÊï∞„Äç„Å®„Åó„Å¶„ÄÄ*/
    /*‚Üì‚Üì„ÄÄ„ÅÇ„Çâ„Åã„Åò„ÇÅË®≠ÂÆö„Åó„Å¶„Åä„Åè„ÅÆ„ÅåintervalID„ÄÇVue.component„ÅÆÂ§ñ„ÅßË®≠ÂÆö„Åó„Å™„ÅÑ„Å®„ÄÄ*/
    /*‚Üì‚Üì„ÄÄVueÂÜÖ„ÅÆfunction„ÇíÁµÇ„Åà„Çã„Åü„Å≥„Å´Ê∂à„Åï„Çå„Å¶„Åó„Åæ„ÅÜ„ÅÆ„Åß„ÄÅ„Åì„Åì„ÅßÂÆ£Ë®Ä„Åó„Å¶„Åä„Åè„ÄÄ*/
    /*‚Üì‚Üì„ÄÄÂèÇÁÖß„ÄÄ„ÄÄhttps://techacademy.jp/magazine/5537„ÄÄ*/
var intervalID
    /*„ÄÄ‚Üì‚Üì„ÄÄ„Éè„Ç∫„É¨„Å†„Å£„ÅüÊôÇ„Å´30ÁßíÈñì„ÄÄÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÇíÈö†„Åô„ÄÇ
    ÂèÇËÄÉ„ÄÄhttps://www.nishishi.com/javascript-tips/temp-box-settimeout.html
    Â§âÊï∞„ÄåinputFormShowTimerID„Äç„ÅØ„ÄÅ„Åù„ÅÆ„Åü„ÇÅ„Å†„Åë„Å´Áî®ÊÑè„Åó„ÅüÂ§âÊï∞*/
var inputFormShowTimerID
    /*„ÄÄ‚Üì‚Üì„ÄÄ„Éè„Ç∫„É¨„Å†„Å£„ÅüÊôÇ„Å´30ÁßíÈñì„ÄÄÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÇíÈö†„Åó„Å¶„ÅÑ„ÇãÈñì„Å´„Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥„ÇíË°®Á§∫„Åô„Çã„ÄÇ
    ÂèÇËÄÉ„ÄÄhttps://www.nishishi.com/javascript-tips/setinterval-passage.html
    Â§â„ÄåcountDownID„Äç„Å®„ÄåcountDownSec„Äç„ÅØ„ÄÅ„Åù„ÅÆ„Åü„ÇÅ„Å†„Åë„Å´Áî®ÊÑè„Åó„ÅüÂ§âÊï∞*/
var countDownID
var countDownSec

//message_board object
Vue.component('message_board',{
    template:'#message_board-template',
    data:function(){

        return{
                in_out:'„É≠„Ç∞„Ç§„É≥',       
                login_flg:false,
                login_name:'',
                login_id:'',
                group_name:'',
                name_id:'',
                form_pass:'',
                login_msg:'„É≠„Ç∞„Ç§„É≥„ÄÄ„Ç¶„Ç£„É≥„Éâ„Ç¶',
                alert_msg:'‚Äª„É≠„Ç∞„Ç§„É≥„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                post_msg:'',
                msg_data:[],
                form_msg:'',
                seikai_flg:'',
                current_stege:'',
                cleared_user_name:'',
                inputform_show:'True',
                current_stege_for_treasurebox:'',
                hazure_countdown_msg:'',
        }
    },
    methods:{
        // check login/logout.
        in_out_check:function(e){
            if(this.login_flg){
                this.logout();
            }else{
                this.show_login();
            }   
        },
        //show login dialog
        show_login:function(){
            this.group_name='';
            this.name_id='';
            this.login_id='';
            this.login_msg='„É≠„Ç∞„Ç§„É≥„ÄÄ„Ç¶„Ç£„É≥„Éâ„Ç¶';
            $('#login').modal('show');
        },
        //show Hazure dialog
        showHazure:function(){
            $('#Hazure').modal('show');
        },
        //hide Hazure dialog
        closeHazure:function(){
            $('#Hazure').modal('hide');
        },
        //show TreasureBox dialog
        showTreasureBox:function(){
            this.seikai_flg='';
            $('#TreasureBox').modal('show');
        },
        //hide TreasureBox dialog
        closeTreasureBox:function(){
            $('#TreasureBox').modal('hide');
        },
        //access server and logined
        login:function(e){
            let formData= new FormData();
            formData.append("group_name",this.group_name);
            formData.append("name_id",this.name_id);
            let self=this;
            $.ajax({
                type:'POST',
                url:'/login',
                data:formData,
                processData:false,
                contentType:false,
            success:function(Data){
                if (Data[0]=='True'){
                    self.in_out='„É≠„Ç∞„Ç¢„Ç¶„Éà';
                    self.login_flg=true;
                    self.login_name=Data[1];
                    self.group_name=Data[2];
                    self.login_id=Data[3];
                    self.current_stege=Data[4];
                    self.alert_msg='‚Äª„É≠„Ç∞„Ç§„É≥„Åó„Åæ„Åó„ÅüÔºÅ ÁèæÂú®„ÄÄÁ¨¨'+self.current_stege+'„Çπ„ÉÜ„Éº„Ç∏„Åß„Åô';
                    /* self.group_name=''; */
                    $('#login').modal('hide');
                    self.getMsg();
                    /*‚Üì‚Üì„ÄÄsetInterval „Çí„Å§„Åã„ÅÜ„Åì„Å®„Åß„ÄÅ‰∏ÄÂÆöÊôÇÈñì„ÅåÁµåÈÅé„Åô„Çã„Å®
                    „ÄÄ„Éá„Éº„Çø„ÇíËá™ÂãïÊõ¥Êñ∞„ÅóÁ∂ö„Åë„Å¶„Åè„Çå„Çã„ÄÄ*/
                /*‚Üì‚Üì„ÄÄgetMsg„Å®„ÅÑ„ÅÜÈñ¢Êï∞„ÇíÂÆöÊúüÁöÑ„Å´Ëá™ÂãïÊõ¥Êñ∞„ÅóÁ∂ö„Åë„Å¶„Åè„Çå„Çã„ÄÄ*/
                /*‚Üì‚Üì„ÄÄ„Ç≥„ÉÑ„ÅØ„ÄÅ√ó„ÄÄgetMsg() „Åß„ÅØ„Å™„Åè   ‚óã„ÄÄgetMsg„ÄÄ„Å®„Åô„Çã„Åì„Å®„ÄÄ*/
                /*‚Üì‚Üì„ÄÄlogout() ÊôÇ„Å´„ÄÅclearInterval()Èñ¢Êï∞„ÅßËß£Èô§„Åï„Çå„Çã„ÄÄ*/
                /*‚Üì‚Üì„ÄÄÂèÇÁÖß„ÄÄ„ÄÄhttps://techacademy.jp/magazine/5537„ÄÄ*/
                    
                    intervalID = setInterval(self.getMsg,10000);
                    
                }else{
                    self.login_msg='„Äå„ÉÅ„Éº„É†Âêç„Äç„ÇÇ„Åó„Åè„ÅØ„ÄåÂêçÂâç„Äç„ÅåÈÅï„ÅÑ„Åæ„Åô';

                }
            },
            error:function(request,status,err){
                self.login_msg='‚ÄªÂïèÈ°å„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü';

            }
        });
    },
    //logout
    logout:function(){
        console.log('logout');
        this.in_out='„É≠„Ç∞„Ç§„É≥';
        this.msg_data=[];
        this.login_flg=false;
        this.login_name='';
        this.login_id='';
        this.alert_msg='‚Äª„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„Åü';
        /*‚Üì‚Üì„ÄÄclearInterval„Å´„Çà„Å£„Å¶„ÄÅsetInterval„Å´„Çà„Çã„Éá„Éº„Çø„ÅÆËá™ÂãïÊõ¥Êñ∞„Çí
        „Çπ„Éà„ÉÉ„Éó„Åï„Åõ„Çã„ÄÄ*/
        /*‚Üì‚Üì„ÄÄÂèÇÁÖß„ÄÄ„ÄÄhttps://techacademy.jp/magazine/5537„ÄÄ*/
        clearInterval(intervalID);

    },
    //post message.
    postMsg:function(){
        let formData=new FormData();
        formData.append("comment",this.post_msg);
        let self=this;
        $.ajax({
            type:'POST',
            url:'/post',
            data:formData,
            processData:false,
            contentType:false,

            success:function(DAT){
                self.post_msg = '';
                self.seikai_flg=DAT[1]
               if(DAT[0]== 'True' &&  self.seikai_flg=='hazure' ) {    
                    self.alert_msg ='‰∏çÊ≠£Ëß£ÔºÅ';
                    /* ‚Üì„ÄÄÈùûÂêåÊúüÂá¶ÁêÜ„Åå„Åó„Å£„Åã„ÇäÁµÇ„Çè„Å£„Å¶„Åã„Çâ„ÄÅshowHazure„ÅåÈñã„Åè„Çà„ÅÜ„Å´„ÄÅpromise„Å´„Çà„Çã„Ç≥„Éº„É´„Éê„ÉÉ„ÇØÈñ¢Êï∞„Çí‰Ωø„ÅÜ */
                    new Promise (resolve =>{
                            self.seikai_flg='';
                            resolve();
                        }).then(()=>self.showHazure());
                
                    self.getMsg(); 
                    /*„ÄÄ‚Üì‚Üì„ÄÄ„Éè„Ç∫„É¨„Å†„Å£„ÅüÊôÇ„Å´30ÁßíÈñì„ÄÄÂÖ•Âäõ„Éï„Ç©„Éº„É†„ÇíÈö†„Åô„ÄÇ
                    ÂèÇËÄÉ„ÄÄhttps://www.nishishi.com/javascript-tips/temp-box-settimeout.html
                    ‰∏äË®òURL„ÅÆ‰∏≠„ÅÆ„Äå‚ñºÂá¶ÁêÜÂÜÖÂÆπ„ÇíÁÑ°ÂêçÈñ¢Êï∞„ÅßË®òËø∞„Åô„ÇãÊõ∏„ÅçÊñπ„Äç„ÇíÂèÇËÄÉ„Å´„Åó„Åü„ÄÇ
                    Â§âÊï∞„ÄåinputFormShowTimerID„Äç„ÅØ„ÄÅ„Åù„ÅÆ„Åü„ÇÅ„Å†„Åë„Å´Áî®ÊÑè„Åó„ÅüÂ§âÊï∞*/
                    self.inputform_show = 'False';
                    inputFormShowTimerID = setTimeout(function(){self.inputform_show = 'True'},30000);
                    countDownSec= 30;
                    countDownID = setInterval(function(){
                                countDownSec--;
                                self.hazure_countdown_msg="„Ç∑„É≥„Ç≠„É≥„Ç∞„Çø„Ç§„É†„ÄÄ"+countDownSec+"ÁßíÂæå„Å´ÂÖ•Âäõ„Åß„Åç„Åæ„Åô";
                                },1000);
                    setTimeout(function(){clearInterval(countDownID)},30000);
                    
                   
                }else if(DAT[0]== 'True' && self.seikai_flg=='' ) {     
                    self.getMsg();  
                    }
            },
            
            error:function(request,status,err){
                self.alert_msg='‚Äª„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°„Å´ÂïèÈ°å„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü';

            }
        });
        
    },
    //delete message.
    delMsg:function(){
        let self = this;
        $.ajax({
            type:'POST',
            url:'/delete',
            processData:false,
            contentType:false,
            success:function(DAT){
                if (DAT== 'True') {
                    self.seikai_flg='';
                    self.alert_msg ='ÂÖ•ÂäõÂ±•Ê≠¥„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü';
                    self.getMsg(); 
                }
            },
            
            error:function(request,status,err){
                self.alert_msg='‚Äª„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°„Å´ÂïèÈ°å„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü';

            }
        });
        
    },  
  // get all messages.
        getMsg: function() {
            let self = this;
            $.ajax({
                type: 'POST',
                url: '/messages',
                processData: false,
                contentType: false,

                success: function (DATA) {
                    /* console.log(DATA); */ 
                    self.msg_data = DATA[0].reverse();
                    self.seikai_flg= DATA[1];
                    self.current_stege=DATA[2];
                    if(self.current_stege ==7){
                            self.alert_msg='„Ç¥„Éº„É´ÔºÅ';
                        }
                        else{self.alert_msg='ÁèæÂú®„ÄÄÁ¨¨'+self.current_stege+'„Çπ„ÉÜ„Éº„Ç∏„Åß„Åô';};
                    
                    
                
                    if(self.seikai_flg=='atari' ) {     
                     
                        self.seikai_flg='';
                        /* console.log(DATA[0]['group']);
                        console.log(self.group_name); */
                        /* ‚Üì„ÄÄÈÄÅ„Çâ„Çå„Å¶„Åç„Åücurrent_stege„ÅÆNo„Çí„ÄÅ-1„Åó„Å¶Â§âÊï∞current_stege_for_treasurebox„Å´ÂÖ•„Çå„Å¶„Åä„Åè
                        Ôºàtreasurebox„ÉÄ„Ç§„Ç¢„É≠„Ç∞„Åå10Áßí„Åî„Å®„Å´Êõ¥Êñ∞„Åï„Çå„Çã„Å®„Åç„Å´„ÄÅÊ¨°„ÅÆ„Çπ„ÉÜ„Éº„Ç∏„ÅÆNo„Å´„Å™„Çâ„Å™„ÅÑ„Çà„ÅÜ„Å´Ôºâ */
                        self.current_stege_for_treasurebox=String(parseFloat(self.current_stege)-1)
                        self.cleared_user_name=DATA[3];
                        /* ‚Üì„ÄÄÈùûÂêåÊúüÂá¶ÁêÜ„Åå„Åó„Å£„Åã„ÇäÁµÇ„Çè„Å£„Å¶„Åã„Çâ„ÄÅshowTreasurebox„ÅåÈñã„Åè„Çà„ÅÜ„Å´„ÄÅpromise„Å´„Çà„Çã„Ç≥„Éº„É´„Éê„ÉÉ„ÇØÈñ¢Êï∞„Çí‰Ωø„ÅÜ */
                        new Promise (resolve =>{
                            if(self.current_stege ==7){
                                self.form_msg = self.cleared_user_name+'„Åï„Çì„Åå„ÄÄÂÖ®„Çπ„ÉÜ„Éº„Ç∏ „ÇØ„É™„Ç¢ÔºÅ';
                            }
                            else{self.form_msg = self.cleared_user_name+'„Åï„Çì„Åå„ÄÄÁ¨¨'+self.current_stege_for_treasurebox+'„Çπ„ÉÜ„Éº„Ç∏ „ÇØ„É™„Ç¢ÔºÅ';};
                            
                          resolve();
                        }).then(()=>self.showTreasureBox());
                        
                        /*‚Üì‚Üì„ÄÄÂÖ®„Çπ„ÉÜ„Éº„Ç∏„Çí„ÇØ„É™„Ç¢„Åó„ÅüÊôÇ„Å´
                        clearInterval„Å´„Çà„Å£„Å¶„ÄÅsetInterval„Å´„Çà„Çã„Éá„Éº„Çø„ÅÆËá™ÂãïÊõ¥Êñ∞„Çí„Çπ„Éà„ÉÉ„Éó„Åï„Åõ„Çã„ÄÄ*/
                        /*‚Üì‚Üì„ÄÄÂèÇÁÖß„ÄÄ„ÄÄhttps://techacademy.jp/magazine/5537„ÄÄ*/
                        if(self.current_stege==7){ 
                            clearInterval(intervalID);
                        }
                        /* self.form_msg = DATA[0][0];
                        && DATA[0]['group'] == self.group_name  */
                        
                        
                        
                        /* 
                        self.showTreasureBox(); */
                    };
                    
                },
                error: function(request, status, err) {
                    self.alert_msg = '‚Äª„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°„Å´ÂïèÈ°å„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ';
                }
            });
        },

    },    
});
//start Vue.
new Vue({
    el:'#app',
});
</script>


{% endblock%}

{% block footer%}
Copyright 2023 <img src ="/static/logo.jpg?20230123"/>
{% endblock%}